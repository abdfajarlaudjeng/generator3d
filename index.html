<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Generator 3D dari BBFS (Patokan AS)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen font-sans text-slate-800 flex">

  <!-- Sidebar -->
  <aside class="w-64 bg-slate-900 text-white flex flex-col fixed top-0 left-0 h-full shadow-lg">
    <div class="p-4 text-xl font-bold border-b border-slate-700">Menu</div>
    <nav class="flex-1 p-4 space-y-2">
      <a href="#" class="block px-3 py-2 rounded hover:bg-slate-700">Dashboard</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-slate-700">Generator 3D</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-slate-700">Generator 4D</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-slate-700">Analisis</a>
      <a href="#" class="block px-3 py-2 rounded hover:bg-slate-700">Pengaturan</a>
    </nav>
    <div class="p-4 border-t border-slate-700 text-sm text-slate-400">
      &copy; 2025 Generator BBFS
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 ml-64 p-6">
    <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-2xl p-6">
      <h1 class="text-2xl font-bold mb-2">Generator 3D — BBFS berdasarkan AS</h1>
      <p class="text-sm text-slate-600 mb-4">Pilih nilai <strong>AS</strong> (0–9) lalu pilih jenis output 3D yang diinginkan.</p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
        <label class="flex flex-col">
          <span class="text-sm font-medium">Pilih AS</span>
          <select id="asSelect" class="mt-1 p-2 rounded border" onchange="onAsChange()">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
          </select>
        </label>

        <label class="flex flex-col">
          <span class="text-sm font-medium">BBFS untuk AS terpilih</span>
          <input id="bbfsInput" class="mt-1 p-2 rounded border bg-slate-50" readonly />
        </label>

        <label class="flex flex-col">
          <span class="text-sm font-medium">Jenis output</span>
          <select id="modeSelect" class="mt-1 p-2 rounded border">
            <option value="sliding">3D Berurutan (sliding window)</option>
            <option value="combination">3D Unik (kombinasi tanpa urutan)</option>
            <option value="permutation">3D Permutasi (urutan dihitung)</option>
          </select>
        </label>
      </div>

      <div class="flex gap-2 mb-4">
        <button class="px-4 py-2 bg-blue-600 text-white rounded shadow" onclick="generate()">Generate</button>
        <button class="px-4 py-2 bg-emerald-600 text-white rounded shadow" onclick="copyResults()">Copy</button>
        <button class="px-4 py-2 bg-amber-500 text-white rounded shadow" onclick="downloadCSV()">Download CSV</button>
        <button class="px-4 py-2 bg-gray-200 rounded shadow" onclick="clearResults()">Clear</button>
      </div>

      <div id="meta" class="text-sm text-slate-600 mb-3"></div>

      <div id="results" class="grid grid-cols-1 gap-3"></div>

      <footer class="text-xs text-slate-500 mt-6">
        Generated by local script — menggunakan peta AS → BBFS yang diberikan.
      </footer>
    </div>
  </main>

<script>
// --- JavaScript sama dengan versi sebelumnya ---
const AS_MAP = {
  '0': '34056789',
  '1': '23456790',
  '2': '12345680',
  '3': '12356789',
  '4': '23457890',
  '5': '12357890',
  '6': '13467809',
  '7': '34567890',
  '8': '12567890',
  '9': '23467890'
};

const asSelect = document.getElementById('asSelect');
const bbfsInput = document.getElementById('bbfsInput');
const modeSelect = document.getElementById('modeSelect');
const resultsDiv = document.getElementById('results');
const metaDiv = document.getElementById('meta');

function onAsChange(){
  const as = asSelect.value;
  bbfsInput.value = AS_MAP[as] || '';
}

function pad3(s){
  s = String(s);
  return s.length === 3 ? s : s.padStart(3,'0');
}

function uniqueSortedDigitsFromString(str){
  const arr = String(str).split('');
  const filt = arr.filter(ch => /[0-9]/.test(ch));
  return Array.from(new Set(filt));
}

function generateSliding(bbfs){
  const res = [];
  for(let i=0;i+2<bbfs.length;i++){
    res.push(pad3(bbfs.slice(i,i+3)));
  }
  return res;
}

function combinations(array, k){
  const res = [];
  const n = array.length;
  function helper(start, chosen){
    if(chosen.length === k){
      res.push(chosen.slice());
      return;
    }
    for(let i=start;i<n;i++){
      chosen.push(array[i]);
      helper(i+1, chosen);
      chosen.pop();
    }
  }
  helper(0, []);
  return res;
}

function permutationsOf(arr){
  const res = [];
  function permute(a, l){
    if(l === a.length-1){
      res.push(a.join(''));
      return;
    }
    for(let i=l;i<a.length;i++){
      [a[l], a[i]] = [a[i], a[l]];
      permute(a, l+1);
      [a[l], a[i]] = [a[i], a[l]];
    }
  }
  permute(arr.slice(), 0);
  return res;
}

function generateCombinations(bbfs){
  const digits = uniqueSortedDigitsFromString(bbfs);
  const comb = combinations(digits, 3);
  return comb.map(c => c.join(''));
}

function generatePermutations(bbfs){
  const digits = uniqueSortedDigitsFromString(bbfs);
  const comb = combinations(digits, 3);
  const perms = [];
  comb.forEach(c =>{
    const p = permutationsOf(c);
    p.forEach(x=> perms.push(x));
  });
  return perms;
}

function generate(){
  const as = asSelect.value;
  const bbfs = AS_MAP[as] || '';
  if(!bbfs){
    alert('BBFS untuk AS terpilih tidak ditemukan');
    return;
  }
  const mode = modeSelect.value;
  resultsDiv.innerHTML = '';
  metaDiv.textContent = '';

  let list = [];
  if(mode === 'sliding'){
    list = generateSliding(bbfs);
    metaDiv.textContent = `Mode: Sliding (berurutan). BBFS: ${bbfs}. Total: ${list.length} item.`;
  } else if(mode === 'combination'){
    list = generateCombinations(bbfs);
    metaDiv.textContent = `Mode: Kombinasi unik. Digit unik: ${uniqueSortedDigitsFromString(bbfs).join(', ')}. Total: ${list.length}.`;
  } else if(mode === 'permutation'){
    list = generatePermutations(bbfs);
    metaDiv.textContent = `Mode: Permutasi (urutan dihitung). Total: ${list.length}.`;
  }

  const card = document.createElement('div');
  card.className = 'p-4 bg-slate-50 rounded border';

  const summary = document.createElement('div');
  summary.className = 'mb-2 text-sm text-slate-700';
  summary.textContent = `Menampilkan ${list.length} angka 3D.`;
  card.appendChild(summary);

  const pre = document.createElement('pre');
  pre.className = 'whitespace-pre-wrap text-sm';
  pre.textContent = list.join(' ');
  card.appendChild(pre);

  resultsDiv.appendChild(card);
}

function copyResults(){
  const text = Array.from(document.querySelectorAll('#results pre')).map(p=>p.textContent).join('\\n');
  if(!text){ alert('Tidak ada hasil untuk disalin'); return; }
  navigator.clipboard.writeText(text).then(()=> alert('Hasil disalin!'));
}

function downloadCSV(){
  const pre = document.querySelector('#results pre');
  if(!pre){ alert('Tidak ada hasil'); return; }
  const items = pre.textContent.split(/\\s+/).filter(Boolean);
  const csv = items.join('\\n');
  const blob = new Blob([csv], {type: 'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = '3d_results.csv';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

function clearResults(){
  resultsDiv.innerHTML = '';
  metaDiv.textContent = '';
}

onAsChange();
</script>
</body>
</html>
